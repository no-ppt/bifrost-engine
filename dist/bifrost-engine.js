define('tween',{});
(function(global,factory){if(typeof define==='function'&&define.amd){define('assets/AssetStatus',['exports'],factory)}else if(typeof exports!=='undefined'){factory(exports)}else {var mod={exports:{}};factory(mod.exports);global.AssetStatus=mod.exports}})(this,function(exports){'use strict';Object.defineProperty(exports,'__esModule',{value:true}); /**
 *
 * @author hermit
 * @version 1.0.0
 * @since 1.0.0
 */var AssetStatus={PENDING:'PENDING',PROCESSING:'PROCESSING',LOADED:'LOADED',FAILURE:'FAILURE'};exports.default=AssetStatus});
(function(global,factory){if(typeof define==="function"&&define.amd){define('core/events/Event',["exports"],factory)}else if(typeof exports!=="undefined"){factory(exports)}else {var mod={exports:{}};factory(mod.exports);global.Event=mod.exports}})(this,function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value" in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}(); /**
 * Event construct template.
 *
 * @type {{_type: String, _target: Object, _timestamp: number, _arguments: Array}}
 */var EVENT_TEMPLATE={type:null,target:null,arguments:[]}; /**
 * The Event interface prevents any event of the EventTarget. It contains common properties and
 * methods to any event.
 *
 * @author hermit
 * @version 1.0.2
 * @since 1.0.0
 */var Event=function(){ /**
     * @param params
     */function Event(params){_classCallCheck(this,Event); // Construct event object by merging parameter.
this._type=params.type||EVENT_TEMPLATE.type;this._target=params.target||EVENT_TEMPLATE.target;this._arguments=params.arguments||EVENT_TEMPLATE.arguments;this._timestamp=new Date().getTime()} /**
     * Get the event create timestamp.
     *
     * @returns {number} Event create time in milliseconds.
     */_createClass(Event,[{key:"timestamp",get:function get(){return this._timestamp}},{key:"type",get:function get(){return this._type}},{key:"target",get:function get(){return this._target}},{key:"arguments",get:function get(){return this._arguments}},{key:"args",get:function get(){return this.arguments}}]);return Event}();exports.default=Event});
(function(global,factory){if(typeof define==='function'&&define.amd){define('core/logger/Logger',['exports'],factory)}else if(typeof exports!=='undefined'){factory(exports)}else {var mod={exports:{}};factory(mod.exports);global.Logger=mod.exports}})(this,function(exports){'use strict';Object.defineProperty(exports,'__esModule',{value:true});function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}(); /**
 * Define the trace level code.
 * @constant
 * @type {number}
 */var TRACE_LEVEL=1; /**
 * Define the debug level code.
 * @type {number}
 */var DEBUG_LEVEL=2; /**
 * Define the info level code.
 * @type {number}
 */var INFO_LEVEL=4; /**
 * Define the warn level code.
 * @type {number}
 */var WARN_LEVEL=8; /**
 * Define the error level code.
 * @type {number}
 */var ERROR_LEVEL=16; /**
 * Define the default log level.(Warn & error in defaults).
 *
 *
 * @constant
 * @type {number}
 */var DEFAULT_LOG_LEVEL=WARN_LEVEL|ERROR_LEVEL;var DEFAULT_LOG_OPTIONS={targetClass:'Logger',level:DEFAULT_LOG_LEVEL}; /**
 * A logger object is used to log message.
 *
 * <h3>Typical usage pattern:</h3>
 * <pre>
 * import { LoggerFactory } from 'logger/LoggerFactory';
 *
 * export class A {
 *     constructor() {
 *         this.logger = LoggerFactory.getLogger();
 *     }
 * }
 * </pre>
 * @author hermit
 * @version 1.0.2
 * @since 1.0.0
 */var Logger=function(){ /**
     * Construct a logger with specified log level.
     *
     * @params options The logger construct options.
     */function Logger(options){_classCallCheck(this,Logger);this._level=options.level||DEFAULT_LOG_OPTIONS.level;this._targetClass=options.targetClass||DEFAULT_LOG_OPTIONS.targetClass} /**
     * Prints a stack trace from the point where the method was called.
     */_createClass(Logger,[{key:'trace',value:function trace(){if(this._isEnabled(TRACE_LEVEL)){this.printTrace()}}},{key:'debug',value:function debug(msg){if(this._isEnabled(DEBUG_LEVEL)){for(var _len=arguments.length,params=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){params[_key-1]=arguments[_key]}this.printDebug.apply(this,[msg].concat(params))}}},{key:'info',value:function info(msg){if(this._isEnabled(INFO_LEVEL)){for(var _len2=arguments.length,params=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){params[_key2-1]=arguments[_key2]}this.printInfo.apply(this,[msg].concat(params))}}},{key:'warn',value:function warn(msg){if(this._isEnabled(WARN_LEVEL)){for(var _len3=arguments.length,params=Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){params[_key3-1]=arguments[_key3]}this.printWarn.apply(this,[msg].concat(params))}}},{key:'error',value:function error(msg){if(this._isEnabled(ERROR_LEVEL)){for(var _len4=arguments.length,params=Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++){params[_key4-1]=arguments[_key4]}this.printError.apply(this,[msg].concat(params))}}},{key:'_isEnabled',value:function _isEnabled(level){return (this._level&level)>0}},{key:'printTrace',value:function printTrace(){}},{key:'printDebug',value:function printDebug(msg){}},{key:'printInfo',value:function printInfo(msg){}},{key:'printWarn',value:function printWarn(msg){}},{key:'printError',value:function printError(msg){}}]);return Logger}();exports.default=Logger});
(function(global,factory){if(typeof define==='function'&&define.amd){define('core/logger/ConsoleLogger',['exports','./Logger'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./Logger'))}else {var mod={exports:{}};factory(mod.exports,global.Logger);global.ConsoleLogger=mod.exports}})(this,function(exports,_Logger2){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Logger3=_interopRequireDefault(_Logger2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ConsoleLogger=function(_Logger){_inherits(ConsoleLogger,_Logger);function ConsoleLogger(){_classCallCheck(this,ConsoleLogger);return _possibleConstructorReturn(this,Object.getPrototypeOf(ConsoleLogger).apply(this,arguments))}_createClass(ConsoleLogger,[{key:'printTrace',value:function printTrace(){if(console.trace){console.trace()}else {console.log(new Error)}}},{key:'printDebug',value:function printDebug(msg){for(var _len=arguments.length,params=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){params[_key-1]=arguments[_key]}if(console.debug){var _console;(_console=console).debug.apply(_console,['[DEBUG]\t['+this._targetClass+']\t'+msg].concat(params))}else {var _console2;(_console2=console).log.apply(_console2,['[DEBUG]\t['+this._targetClass+']\t'+msg].concat(params))}}},{key:'printInfo',value:function printInfo(msg){for(var _len2=arguments.length,params=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){params[_key2-1]=arguments[_key2]}if(console.info){var _console3;(_console3=console).info.apply(_console3,['[INFO]\t['+this._targetClass+']\t'+msg].concat(params))}else {var _console4;(_console4=console).log.apply(_console4,['[INFO]\t['+this._targetClass+']\t'+msg].concat(params))}}},{key:'printWarn',value:function printWarn(msg){for(var _len3=arguments.length,params=Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){params[_key3-1]=arguments[_key3]}if(console.warn){var _console5;(_console5=console).warn.apply(_console5,['[WARN]\t['+this._targetClass+']\t'+msg].concat(params))}else {var _console6;(_console6=console).log.apply(_console6,['[WARN]\t['+this._targetClass+']\t'+msg].concat(params))}}},{key:'printError',value:function printError(msg){for(var _len4=arguments.length,params=Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++){params[_key4-1]=arguments[_key4]}if(console.error){var _console7;(_console7=console).error.apply(_console7,[new Error('[ERROR]\t['+this._targetClass+']\t'+msg)].concat(params))}else {var _console8;(_console8=console).log.apply(_console8,[new Error('[ERROR]\t['+this._targetClass+']\t'+msg)].concat(params))}}}]);return ConsoleLogger}(_Logger3.default);exports.default=ConsoleLogger});
(function(global,factory){if(typeof define==='function'&&define.amd){define('core/logger/LoggerFactory',['exports','./ConsoleLogger'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./ConsoleLogger'))}else {var mod={exports:{}};factory(mod.exports,global.ConsoleLogger);global.LoggerFactory=mod.exports}})(this,function(exports,_ConsoleLogger){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _ConsoleLogger2=_interopRequireDefault(_ConsoleLogger);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}(); /**
 * Default logger configure.
 *
 * @type {{level}}
 */var DEFAULT_CONFIG={level:function(){var level=void 0;if(typeof window!=='undefined'&&window.location&&window.location.hash){var arr=window.location.hash.substring(1).split(',');arr.forEach(function(param){var pair=param.split('=');if(pair[0]==='logger.level'){level=pair[1]||null}})}return level}()}; /**
 * @author hermit
 * @version 1.0.0
 * @since 1.0.0
 */var LoggerFactory=function(){function LoggerFactory(){_classCallCheck(this,LoggerFactory)}_createClass(LoggerFactory,null,[{key:'getLogger',value:function getLogger(clazz){var options=arguments.length<=1||arguments[1]===undefined?DEFAULT_CONFIG:arguments[1];return new _ConsoleLogger2.default({targetClass:clazz,level:options.level})}}]);return LoggerFactory}();exports.default=LoggerFactory});
(function(global,factory){if(typeof define==='function'&&define.amd){define('core/events/EventListener',['exports','../logger/LoggerFactory'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('../logger/LoggerFactory'))}else {var mod={exports:{}};factory(mod.exports,global.LoggerFactory);global.EventListener=mod.exports}})(this,function(exports,_LoggerFactory){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _LoggerFactory2=_interopRequireDefault(_LoggerFactory);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var EventListener=function(){function EventListener(){_classCallCheck(this,EventListener)}_createClass(EventListener,[{key:'handleEvent',value:function handleEvent(event){}}]);return EventListener}();exports.default=EventListener});
(function(global,factory){if(typeof define==="function"&&define.amd){define('core/utils/ContextHelper',["exports"],factory)}else if(typeof exports!=="undefined"){factory(exports)}else {var mod={exports:{}};factory(mod.exports);global.ContextHelper=mod.exports}})(this,function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value" in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var ContextHelper=function(){function ContextHelper(){_classCallCheck(this,ContextHelper)}_createClass(ContextHelper,null,[{key:"delegate",value:function delegate(func,context){return function(){for(var _len=arguments.length,params=Array(_len),_key=0;_key<_len;_key++){params[_key]=arguments[_key]}func.apply(context,params)}}}]);return ContextHelper}();exports.default=ContextHelper});
(function(global,factory){if(typeof define==='function'&&define.amd){define('core/events/EventTarget',['exports','../events/Event','../events/EventListener','../logger/LoggerFactory','../utils/ContextHelper'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('../events/Event'),require('../events/EventListener'),require('../logger/LoggerFactory'),require('../utils/ContextHelper'))}else {var mod={exports:{}};factory(mod.exports,global.Event,global.EventListener,global.LoggerFactory,global.ContextHelper);global.EventTarget=mod.exports}})(this,function(exports,_Event,_EventListener,_LoggerFactory,_ContextHelper){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Event2=_interopRequireDefault(_Event);var _EventListener2=_interopRequireDefault(_EventListener);var _LoggerFactory2=_interopRequireDefault(_LoggerFactory);var _ContextHelper2=_interopRequireDefault(_ContextHelper);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else {return Array.from(arr)}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}(); /**
 * Wildcard event type.
 *
 * @constant
 * @type {string}
 */var EVENT_WILDCARD='*'; // Define logger.
var logger=_LoggerFactory2.default.getLogger('EventTarget'); /**
 * EventTarget is an interface implemented by objects that can receive events
 * and may have listeners for them.
 *
 * @author hermit
 * @version 1.0.2
 * @since 1.0.0
 */var EventTarget=function(){ /**
     * Construct event target instance.
     * @constructor
     */function EventTarget(){_classCallCheck(this,EventTarget); // Create empty events map.
this._events=new Map} /**
     * The EventTarget.addEventListener() method registers the specified listener on the EventTarget
     * it's called on. The event target may be an instance of EventTarget.
     *
     * @param type      A string representing the event type to listen for.
     * @param listener  The object that receives a notification when an event of the specified type
     *                  occurs. This must be an object implementing the EventListener interface, or
     *                  simply a JavaScript function.
     * @returns {EventTarget} Current context object.
     */_createClass(EventTarget,[{key:'addEventListener',value:function addEventListener(type,listener){ // Check parameter legality.
this._checkEventType(type);this._checkEventListener(listener); // Emit 'ListenerRegistered' event before registers the specified listener.
this.dispatchEvent(new _Event2.default({type:'ListenerRegistered',target:this,arguments:[listener]})); // Registers the specified listener.
if(!this._events.has(type)){this._events.set(type,[])}this._events.get(type).push(listener);logger.debug('[addEventListener] New listener of \''+type+'\' registered.',this);return this}},{key:'on',value:function on(type,listener){return this.addEventListener(type,listener)}},{key:'addListener',value:function addListener(type,listener){return this.addEventListener(type,listener)}},{key:'detachEvent',value:function detachEvent(type,listener){return this.addEventListener(type,listener)}},{key:'removeListener',value:function removeListener(type,listener){ // Check parameter legality.
this._checkEventType(type);this._checkEventListener(listener);var list=this._events.get(type);var position=list.indexOf(listener);if(position<0){return this}if(list.length===1){this._events.delete(type)}else {list.splice(position,1)} // Emit 'ListenerRemoved' event after remove the listener.
this.dispatchEvent(new _Event2.default({type:'ListenerRemoved',target:this,arguments:[listener]}));logger.debug('[removeListener] A listener of \''+type+'\' has been unregistered.',this);return this}},{key:'removeAllListener',value:function removeAllListener(type){ // Check parameter legality.
this._checkEventType(type);if(!this._events.has(type)){return this} // Emit 'ListenerRemoved'.
this.dispatchEvent(new _Event2.default({type:'ListenerRemoved',target:this,arguments:[this._events.get(type)]})); // Remove all listener(s) listen to specified event type.
this._events.delete(type);logger.debug('[removeAllListener] All listener(s) of \''+type+'\' has been unregistered.',this);return this}},{key:'clearEventListener',value:function clearEventListener(){ // Emit 'ListenerRemoved'.
this.dispatchEvent(new _Event2.default({type:'ListenerRemoved',target:this,arguments:[[].concat(_toConsumableArray(this._events.values()))]})); // Clear all listener(s) in this object.
this._events.clear();logger.debug('[clearEventListener] All listener(s) has been unregistered.')}},{key:'dispatchEvent',value:function dispatchEvent(event){ // Check parameter legality.
this._checkEvent(event); // Dispatch event to all listeners which listening on the specified event type.
if(this._events.has(event.type)){this._events.get(event.type).forEach(function(listener){this._dispatch(event,listener)},this)} // Dispatch event to all listeners which listening on the wildcard event type.
if(this._events.has(EVENT_WILDCARD)){this._events.get(EVENT_WILDCARD).forEach(function(listener){this._dispatch(event,listener)},this)}logger.debug('[dispatchEvent] Event \''+event.type+'\' dispatched.',event);return this}},{key:'propagateEvent',value:function propagateEvent(type,target){target.addEventListener(type,_ContextHelper2.default.delegate(function(event){this.dispatchEvent(event)},this))}},{key:'delegateEvent',value:function delegateEvent(type,target){target.addEventListener(type,_ContextHelper2.default.delegate(function(event){this.dispatchEvent(new _Event2.default({type:event.type,target:this,arguments:[event].concat(event.arguments)}))},this))}},{key:'emit',value:function emit(event){return this.dispatchEvent(event)}},{key:'fireEvent',value:function fireEvent(event){return this.dispatchEvent(event)}},{key:'_dispatch',value:function _dispatch(event,listener){if(listener instanceof _EventListener2.default){listener.handleEvent.apply(listener,[event].concat(_toConsumableArray(event.arguments)))}else {listener.call.apply(listener,[this,event].concat(_toConsumableArray(event.arguments)))}}},{key:'_checkEvent',value:function _checkEvent(event){if(!event||!(event instanceof _Event2.default)){var msg='[_checkEvent] Event must be an instance of "event/Event".';logger.error(msg,event);throw new Error(msg,event)}}},{key:'_checkEventType',value:function _checkEventType(type){if(!type||typeof type!=='string'||type.length===0){var msg='[_checkEventType] Event type must be a string.';logger.error(msg,type);throw new Error(msg,type)}}},{key:'_checkEventListener',value:function _checkEventListener(listener){if(!listener||!(typeof listener==='function'||listener instanceof _EventListener2.default)){var msg='[_checkEventListener] Listener must be an object implementing the '+'EventListener interface, or simply a JavaScript function.';logger.error(msg,listener);throw new Error(msg,listener)}}}]);return EventTarget}();exports.default=EventTarget});
(function(global,factory){if(typeof define==="function"&&define.amd){define('core/utils/ObjectUtils',["exports"],factory)}else if(typeof exports!=="undefined"){factory(exports)}else {var mod={exports:{}};factory(mod.exports);global.ObjectUtils=mod.exports}})(this,function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value" in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var ObjectUtils=function(){function ObjectUtils(){_classCallCheck(this,ObjectUtils)}_createClass(ObjectUtils,null,[{key:"copyProperties",value:function copyProperties(target){for(var _len=arguments.length,sources=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){sources[_key-1]=arguments[_key]}sources.forEach(function(source){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=Reflect.ownKeys(source)[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var key=_step.value;if(key!=="constructor"&&key!=="prototype"&&key!=="name"){var desc=Object.getOwnPropertyDescriptor(source,key);Object.defineProperty(target,key,desc)}}}catch(err){_didIteratorError=true;_iteratorError=err}finally {try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally {if(_didIteratorError){throw _iteratorError}}}})}}]);return ObjectUtils}();exports.default=ObjectUtils});
(function(global,factory){if(typeof define==='function'&&define.amd){define('core/utils/ClassUtils',['exports','./ObjectUtils'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./ObjectUtils'))}else {var mod={exports:{}};factory(mod.exports,global.ObjectUtils);global.ClassUtils=mod.exports}})(this,function(exports,_ObjectUtils){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _ObjectUtils2=_interopRequireDefault(_ObjectUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var ClassUtils=function(){function ClassUtils(){_classCallCheck(this,ClassUtils)}_createClass(ClassUtils,null,[{key:'mixin',value:function mixin(target){for(var _len=arguments.length,sources=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){sources[_key-1]=arguments[_key]}sources.forEach(function(source){_ObjectUtils2.default.copyProperties(target,source);_ObjectUtils2.default.copyProperties(target.prototype,source.prototype)})}}]);return ClassUtils}();exports.default=ClassUtils});
(function(global,factory){if(typeof define==="function"&&define.amd){define('core/utils/UUID',["exports"],factory)}else if(typeof exports!=="undefined"){factory(exports)}else {var mod={exports:{}};factory(mod.exports);global.UUID=mod.exports}})(this,function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value" in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var UUID=function(){function UUID(){_classCallCheck(this,UUID)}_createClass(UUID,null,[{key:"generate",value:function generate(){return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)}).toUpperCase()}}]);return UUID}();exports.default=UUID});
(function(global,factory){if(typeof define==='function'&&define.amd){define('assets/Asset',['exports','./AssetStatus','../core/events/Event','../core/events/EventTarget','../core/utils/ClassUtils','../core/utils/UUID'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./AssetStatus'),require('../core/events/Event'),require('../core/events/EventTarget'),require('../core/utils/ClassUtils'),require('../core/utils/UUID'))}else {var mod={exports:{}};factory(mod.exports,global.AssetStatus,global.Event,global.EventTarget,global.ClassUtils,global.UUID);global.Asset=mod.exports}})(this,function(exports,_AssetStatus,_Event,_EventTarget2,_ClassUtils,_UUID){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _AssetStatus2=_interopRequireDefault(_AssetStatus);var _Event2=_interopRequireDefault(_Event);var _EventTarget3=_interopRequireDefault(_EventTarget2);var _ClassUtils2=_interopRequireDefault(_ClassUtils);var _UUID2=_interopRequireDefault(_UUID);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Asset=function(_EventTarget){_inherits(Asset,_EventTarget);function Asset(){var id=arguments.length<=0||arguments[0]===undefined?_UUID2.default.generate():arguments[0];_classCallCheck(this,Asset);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(Asset).call(this)); // Define attributes.
_this._id=id;_this._status=_AssetStatus2.default.PENDING;return _this}_createClass(Asset,[{key:'id',get:function get(){return this._id}},{key:'status',set:function set(value){var before=this._status;this._status=value;this.dispatchEvent(new _Event2.default({type:'StatusChange',target:this,arguments:[{before:before,after:this._status}]}))},get:function get(){return this._status}}]);return Asset}(_EventTarget3.default);exports.default=Asset});
(function(global,factory){if(typeof define==='function'&&define.amd){define('assets/ImageAsset',['exports','./Asset','./AssetStatus','../core/events/Event','../core/utils/ContextHelper'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./Asset'),require('./AssetStatus'),require('../core/events/Event'),require('../core/utils/ContextHelper'))}else {var mod={exports:{}};factory(mod.exports,global.Asset,global.AssetStatus,global.Event,global.ContextHelper);global.ImageAsset=mod.exports}})(this,function(exports,_Asset2,_AssetStatus,_Event,_ContextHelper){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Asset3=_interopRequireDefault(_Asset2);var _AssetStatus2=_interopRequireDefault(_AssetStatus);var _Event2=_interopRequireDefault(_Event);var _ContextHelper2=_interopRequireDefault(_ContextHelper);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var DEFAULT_OPTIONS={id:null,src:null}; /**
 *
 * @author hermit
 * @version 1.0.0
 */var ImageAsset=function(_Asset){_inherits(ImageAsset,_Asset);function ImageAsset(){var options=arguments.length<=0||arguments[0]===undefined?DEFAULT_OPTIONS:arguments[0];_classCallCheck(this,ImageAsset);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(ImageAsset).call(this,options.id)); // Define image and src.
_this._src=options.src;_this._image=new Image; // Bind events.
_this._bindEvents();return _this}_createClass(ImageAsset,[{key:'load',value:function load(){this._image.src=this._src;this.status=_AssetStatus2.default.PROCESSING}},{key:'_bindEvents',value:function _bindEvents(){this._image.addEventListener('load',_ContextHelper2.default.delegate(this._imageLoadHandler,this));this._image.addEventListener('error',_ContextHelper2.default.delegate(this._imageErrorHandler,this))}},{key:'_imageLoadHandler',value:function _imageLoadHandler(){this.status=_AssetStatus2.default.LOADED}},{key:'_imageErrorHandler',value:function _imageErrorHandler(){this.status=_AssetStatus2.default.FAILURE}},{key:'src',get:function get(){return this._src},set:function set(value){this._src=value}},{key:'image',get:function get(){return this._image}}]);return ImageAsset}(_Asset3.default);exports.default=ImageAsset});
(function(global,factory){if(typeof define==='function'&&define.amd){define('assets/FontAsset',['exports','./Asset'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./Asset'))}else {var mod={exports:{}};factory(mod.exports,global.Asset);global.FontAsset=mod.exports}})(this,function(exports,_Asset2){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Asset3=_interopRequireDefault(_Asset2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var FontAsset=function(_Asset){_inherits(FontAsset,_Asset);function FontAsset(){_classCallCheck(this,FontAsset);return _possibleConstructorReturn(this,Object.getPrototypeOf(FontAsset).apply(this,arguments))}return FontAsset}(_Asset3.default);exports.default=FontAsset});
(function(global,factory){if(typeof define==='function'&&define.amd){define('assets/AssetFactory',['exports','./ImageAsset','./FontAsset','../core/logger/LoggerFactory'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./ImageAsset'),require('./FontAsset'),require('../core/logger/LoggerFactory'))}else {var mod={exports:{}};factory(mod.exports,global.ImageAsset,global.FontAsset,global.LoggerFactory);global.AssetFactory=mod.exports}})(this,function(exports,_ImageAsset,_FontAsset,_LoggerFactory){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _ImageAsset2=_interopRequireDefault(_ImageAsset);var _FontAsset2=_interopRequireDefault(_FontAsset);var _LoggerFactory2=_interopRequireDefault(_LoggerFactory);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var logger=_LoggerFactory2.default.getLogger('AssetFactory'); /**
 *
 * @author hermit
 * @version 1.0.0
 */var AssetFactory=function(){function AssetFactory(){_classCallCheck(this,AssetFactory)}_createClass(AssetFactory,null,[{key:'create',value:function create(data){switch(data.type){case 'ImageAsset':return new _ImageAsset2.default(data);case 'FontAsset':return new _FontAsset2.default(data);default:logger.error('[create] Unsupported asset type ['+data.type+']');}}}]);return AssetFactory}();exports.default=AssetFactory});
(function(global,factory){if(typeof define==='function'&&define.amd){define('assets/AssetManager',['exports','./Asset','./AssetStatus','./AssetFactory','../core/events/Event','../core/events/EventTarget','../core/utils/ContextHelper'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./Asset'),require('./AssetStatus'),require('./AssetFactory'),require('../core/events/Event'),require('../core/events/EventTarget'),require('../core/utils/ContextHelper'))}else {var mod={exports:{}};factory(mod.exports,global.Asset,global.AssetStatus,global.AssetFactory,global.Event,global.EventTarget,global.ContextHelper);global.AssetManager=mod.exports}})(this,function(exports,_Asset,_AssetStatus,_AssetFactory,_Event,_EventTarget2,_ContextHelper){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Asset2=_interopRequireDefault(_Asset);var _AssetStatus2=_interopRequireDefault(_AssetStatus);var _AssetFactory2=_interopRequireDefault(_AssetFactory);var _Event2=_interopRequireDefault(_Event);var _EventTarget3=_interopRequireDefault(_EventTarget2);var _ContextHelper2=_interopRequireDefault(_ContextHelper);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass} // Define the singleton and the enforcer.
var singleton=Symbol();var singletonEnforcer=Symbol(); /**
 *
 * @author hermit
 * @version 1.0.0
 */var AssetManager=function(_EventTarget){_inherits(AssetManager,_EventTarget); /**
     * Private constructor for create singleton.
     * Use 'AssetManager.instance' to get the singleton instance.
     */function AssetManager(enforcer){_classCallCheck(this,AssetManager);if(enforcer!=singletonEnforcer){var msg='[constructor] Cannot instantiate singleton with constructor.';throw new Error(msg)}var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(AssetManager).call(this)); // Define the asset map.
_this._assets=new Map;return _this} /**
     * Get the singleton.
     * @returns { AssetManager } the singleton.
     */_createClass(AssetManager,[{key:'add',value:function add(asset){if(asset instanceof _Asset2.default){this._assets.set(asset.id,asset)}else if(asset instanceof Array){asset.forEach(this.add,this)}else {this.add(this.load(asset))}}},{key:'load',value:function load(data){ // Return directly.
if(data instanceof _Asset2.default){return data} // Return mapped array.
if(data instanceof Array){return data.map(this.load,this)} // TODO: Refactor 'type' to 'class'
var asset=_AssetFactory2.default.create(data);asset.addEventListener('StatusChange',_ContextHelper2.default.delegate(this._assetStatusChangeHandler,this));asset.load();return asset}},{key:'get',value:function get(id){return this._assets.get(id)}},{key:'remove',value:function remove(asset){ // Get asset by id.
if(typeof asset==='string'){asset=this._assets.get(asset)} // Remove event listener.
asset.removeEventListener(this._assetStatusChangeHandler)}},{key:'clear',value:function clear(){ // Release assets.
this._assets.clear()}},{key:'_assetStatusChangeHandler',value:function _assetStatusChangeHandler(event,change){ // Asset has been loaded successfully.
if(change.after===_AssetStatus2.default.LOADED){this.dispatchEvent(new _Event2.default({type:'AssetLoadSuccess',target:this,arguments:[event.target]}))} // Asset cannot be loaded.
if(change.after===_AssetStatus2.default.FAILURE){this.dispatchEvent(new _Event2.default({type:'AssetLoadFailure',target:this,arguments:[event.target]}))}}}],[{key:'instance',get:function get(){if(!this[singleton]){this[singleton]=new AssetManager(singletonEnforcer)}return this[singleton]}}]);return AssetManager}(_EventTarget3.default);exports.default=AssetManager});
define('three',{});
(function(global,factory){if(typeof define==='function'&&define.amd){define('component/Component',['exports','three','../core/utils/UUID'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('three'),require('../core/utils/UUID'))}else {var mod={exports:{}};factory(mod.exports,global.three,global.UUID);global.Component=mod.exports}})(this,function(exports,_three,_UUID){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _three2=_interopRequireDefault(_three);var _UUID2=_interopRequireDefault(_UUID);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else {return get(parent,property,receiver)}}else if('value' in desc){return desc.value}else {var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var DEFAULT_OPTIONS={id:_UUID2.default.generate(),opacity:1,position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1}}; /**
 *
 * @author hermit
 * @version 1.0.0
 */var Component=function(_THREE$Object3D){_inherits(Component,_THREE$Object3D);function Component(params){_classCallCheck(this,Component);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(Component).call(this)); // Merge options.
_this._options=Object.assign({},DEFAULT_OPTIONS,params);_this._options.position=Object.assign({},DEFAULT_OPTIONS.position,params.position);_this._options.rotation=Object.assign({},DEFAULT_OPTIONS.rotation,params.rotation);_this._options.scale=Object.assign({},DEFAULT_OPTIONS.scale,params.scale); // Save the component id. NOTICE: Three.js id field is readonly.
_this.name=_this._options.id; // Set opacity.
_this._opacity=_this._options.opacity; // Set position and rotation.
_this.position.x=_this._options.position.x;_this.position.y=_this._options.position.y;_this.position.z=_this._options.position.z;_this.rotation.x=_this._options.rotation.x*Math.PI/180;_this.rotation.y=_this._options.rotation.y*Math.PI/180;_this.rotation.z=_this._options.rotation.z*Math.PI/180; // Set scale.
_this.scale.x=_this._options.scale.x;_this.scale.y=_this._options.scale.y;_this.scale.z=_this._options.scale.z;return _this}_createClass(Component,[{key:'updateOpacity',value:function updateOpacity(){if(this.children){this.children.forEach(function(child){if(child instanceof Component){child.updateOpacity()}})}}},{key:'add',value:function add(child){_get(Object.getPrototypeOf(Component.prototype),'add',this).call(this,child); // Update opacity if instanceof component.
if(child instanceof Component){child.updateOpacity()}}},{key:'opacity',get:function get(){if(this.parent&&this.parent instanceof Component){return this._opacity*this.parent.opacity}return this._opacity},set:function set(value){this._opacity=value; // Update opacity if has children.
this.updateOpacity()}}]);return Component}(_three2.default.Object3D);exports.default=Component});
(function(global,factory){if(typeof define==='function'&&define.amd){define('component/container/Container',['exports','../Component'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('../Component'))}else {var mod={exports:{}};factory(mod.exports,global.Component);global.Container=mod.exports}})(this,function(exports,_Component2){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Component3=_interopRequireDefault(_Component2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Container=function(_Component){_inherits(Container,_Component);function Container(){_classCallCheck(this,Container);return _possibleConstructorReturn(this,Object.getPrototypeOf(Container).apply(this,arguments))}return Container}(_Component3.default);exports.default=Container});
(function(global,factory){if(typeof define==='function'&&define.amd){define('component/image/GenericImage',['exports','three','../Component','../../assets/AssetManager','../../assets/AssetStatus','../../core/utils/ContextHelper'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('three'),require('../Component'),require('../../assets/AssetManager'),require('../../assets/AssetStatus'),require('../../core/utils/ContextHelper'))}else {var mod={exports:{}};factory(mod.exports,global.three,global.Component,global.AssetManager,global.AssetStatus,global.ContextHelper);global.GenericImage=mod.exports}})(this,function(exports,_three,_Component2,_AssetManager,_AssetStatus,_ContextHelper){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _three2=_interopRequireDefault(_three);var _Component3=_interopRequireDefault(_Component2);var _AssetManager2=_interopRequireDefault(_AssetManager);var _AssetStatus2=_interopRequireDefault(_AssetStatus);var _ContextHelper2=_interopRequireDefault(_ContextHelper);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass} /**
 * Default image offset.
 *
 * @type {{x: number, y: number}}
 */var DEFAULT_OFFSET={x:0,y:0};var DEFAULT_TEXTURE_SCALE={x:1,y:1}; /**
 * Generic image for display pixel image.
 *
 * @author hermit
 * @version 2.0.0
 * @since 1.0.0
 */var GenericImage=function(_Component){_inherits(GenericImage,_Component); /**
     * Create image component with specified parameters.
     *
     * @param params image component info.
     */function GenericImage(params){_classCallCheck(this,GenericImage);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(GenericImage).call(this,params)); // Merge options.
_this._options.offset=Object.assign({},DEFAULT_OFFSET,params.offset);_this._options.textureScale=Object.assign({},DEFAULT_TEXTURE_SCALE,params.imageScale); // Create mesh.
_this._imageMesh=_this._createMesh();_this.add(_this._imageMesh);return _this}_createClass(GenericImage,[{key:'updateOpacity',value:function updateOpacity(){this._imageMesh.material.opacity=this.opacity}},{key:'_createMesh',value:function _createMesh(){return new _three2.default.Mesh(this._createGeometry(),this._createMaterial())}},{key:'_createGeometry',value:function _createGeometry(){return new _three2.default.PlaneBufferGeometry(this._options.width,this._options.height)}},{key:'_createMaterial',value:function _createMaterial(){var texture=this._createTexture(); // Create material.
var material=new _three2.default.MeshBasicMaterial({map:texture,transparent:true,depthWrite:false,depthTest:true,side:_three2.default.DoubleSide}); // Set opacity.
material.opacity=this.opacity;return material}},{key:'_createTexture',value:function _createTexture(){ // Get asset from asset manager.
var asset=this._getAsset(); // Create texture.
var texture=new _three2.default.Texture(asset.image,_three2.default.UVMapping,_three2.default.ClampToEdgeWrapping,_three2.default.ClampToEdgeWrapping,_three2.default.LinearFilter,_three2.default.LinearFilter,_three2.default.RGBAFormat,_three2.default.UnsignedByteType,16); // Set texture UV mapping.
texture.repeat.x=1/this._options.textureScale.x;texture.repeat.y=1/this._options.textureScale.y;texture.offset.x=-this._options.offset.x;texture.offset.y=1-texture.repeat.y+this._options.offset.y;texture.polygonOffset=this._options.polygonOffset;texture.polygonOffsetFactor=this._options.polygonOffsetFactor;texture.polygonOffsetUnits=this._options.polygonOffsetUnits; // Bind asset event.
asset.addEventListener('StatusChange',_ContextHelper2.default.delegate(function(event,change){if(change.after===_AssetStatus2.default.LOADED){ // Update texture min filter.
if(this._isMipMap(asset.image)){texture.minFilter=_three2.default.LinearMipMapLinearFilter}texture.needsUpdate=true}},this)); // Update texture min filter.
if(this._isMipMap(asset.image)){texture.minFilter=_three2.default.LinearMipMapLinearFilter}texture.needsUpdate=true;return texture}},{key:'_isMipMap',value:function _isMipMap(image){ //noinspection JSBitwiseOperatorUsage
return !(image.width&image.width-1)&&!(image.height&image.height-1)}},{key:'_getAsset',value:function _getAsset(){var asset=void 0;if(this._options.src.substr(0,4)==='ref:'){ // Get image asset from asset manager.
var id=this._options.src.substr(4);asset=_AssetManager2.default.instance.get(id)}else { // TODO: Test
asset=_AssetManager2.default.load({type:'ImageAsset',src:this._options.src});_AssetManager2.default.add(asset)}return asset}}]);return GenericImage}(_Component3.default);exports.default=GenericImage});
(function(global,factory){if(typeof define==='function'&&define.amd){define('component/text/PlaneText',['exports','three','../Component','../../core/utils/ContextHelper'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('three'),require('../Component'),require('../../core/utils/ContextHelper'))}else {var mod={exports:{}};factory(mod.exports,global.three,global.Component,global.ContextHelper);global.PlaneText=mod.exports}})(this,function(exports,_three,_Component2,_ContextHelper){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _three2=_interopRequireDefault(_three);var _Component3=_interopRequireDefault(_Component2);var _ContextHelper2=_interopRequireDefault(_ContextHelper);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var FLEX_VERTICAL_ALIGN_MAPPING={top:'flex-start',center:'center',bottom:'flex-end'};var DEFAULT_ALIGN={vertical:'top'}; /**
 * Default texture offset.
 *
 * @type {{x: number, y: number}}
 */var DEFAULT_OFFSET={x:0,y:0};var DEFAULT_TEXTURE_SCALE={x:1,y:1}; /**
 *
 * @author hermit
 * @version 1.0.0
 */var PlaneText=function(_Component){_inherits(PlaneText,_Component);function PlaneText(params){_classCallCheck(this,PlaneText);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(PlaneText).call(this,params)); // Merge options.
_this._options.offset=Object.assign({},DEFAULT_OFFSET,params.offset);_this._options.padding=params.padding||0;_this._options.align=Object.assign({},DEFAULT_ALIGN,params.align);_this._options.textureScale=Object.assign({},DEFAULT_TEXTURE_SCALE); // Create mesh.
_this._textMesh=_this._createMesh();_this.add(_this._textMesh);return _this}_createClass(PlaneText,[{key:'updateOpacity',value:function updateOpacity(){this._textMesh.material.opacity=this.opacity}},{key:'_createMesh',value:function _createMesh(){return new _three2.default.Mesh(this._createGeometry(),this._createMaterial())}},{key:'_createGeometry',value:function _createGeometry(){return new _three2.default.PlaneBufferGeometry(this._options.width,this._options.height)}},{key:'_createMaterial',value:function _createMaterial(){var texture=this._createTexture(); // Create material.
var material=new _three2.default.MeshBasicMaterial({map:texture,transparent:true,depthWrite:false,depthTest:true,side:_three2.default.DoubleSide}); // Set opacity.
material.opacity=this.opacity;return material}},{key:'_createTexture',value:function _createTexture(){ // Calculate the MipMap size.
this._mipmapWidth=this._nearestPowValue(this._options.width);this._mipmapHeight=this._nearestPowValue(this._options.height);this._options.textureScale.x=this._mipmapWidth/this._options.width;this._options.textureScale.y=this._mipmapHeight/this._options.height; // Create SVG image.
var canvas=this._createCanvas();var svg=this._createSVG(); // Create texture.
var texture=new _three2.default.Texture(canvas,_three2.default.UVMapping,_three2.default.ClampToEdgeWrapping,_three2.default.ClampToEdgeWrapping,_three2.default.LinearFilter,_three2.default.LinearFilter,_three2.default.RGBAFormat,_three2.default.UnsignedByteType,16); // Set texture UV mapping.
texture.repeat.x=1/this._options.textureScale.x;texture.repeat.y=1/this._options.textureScale.y;texture.offset.x=-this._options.offset.x;texture.offset.y=1-texture.repeat.y+this._options.offset.y; // Set polygon offset to ensure z-index.
texture.polygonOffset=this._options.polygonOffset;texture.polygonOffsetFactor=this._options.polygonOffsetFactor;texture.polygonOffsetUnits=this._options.polygonOffsetUnits; // Draw SVG to canvas.
this._draw(canvas,svg).then(_ContextHelper2.default.delegate(function(image){ // Update texture min filter.
if(this._isMipMap(image)){texture.minFilter=_three2.default.LinearMipMapLinearFilter}texture.needsUpdate=true},this)).catch(function(e){throw e});return texture}},{key:'_draw',value:function _draw(canvas,svg){return new Promise(_ContextHelper2.default.delegate(function(resolve,reject){var image=new Image;image.addEventListener('load',function(){ // Get context 2d.
var context=canvas.getContext('2d');context.drawImage(image,0,0); // Resolve promise.
resolve(image)});image.addEventListener('error',function(e){reject(e)});image.src='data:image/svg+xml;charset=utf-8,'+svg},this))}},{key:'_createCanvas',value:function _createCanvas(){var canvas=document.createElement('canvas');canvas.width=this._mipmapWidth;canvas.height=this._mipmapHeight;return canvas}},{key:'_createSVG',value:function _createSVG(){ // Create DIV & fix '&nbsp;' problem.
var div=this._createElementDiv();var html=div.outerHTML.replace(/&nbsp;/g,'<span style="color: transparent;">,</span>');return '<svg xmlns="http://www.w3.org/2000/svg" '+(' width="'+this._mipmapWidth*window.devicePixelRatio+'" ')+(' height="'+this._mipmapHeight*window.devicePixelRatio+'">')+'<foreignObject width="100%" height="100%">'+('<div id="foreignObject" xmlns="http://www.w3.org/1999/xhtml">'+html+'</div>')+'</foreignObject>'+'</svg>'}},{key:'_createElementDiv',value:function _createElementDiv(){var div=document.createElement('div');div.style.display='flex';div.style.flexFlow='wrap';div.style.alignContent=FLEX_VERTICAL_ALIGN_MAPPING[this._options.align.vertical];div.style.alignItems=FLEX_VERTICAL_ALIGN_MAPPING[this._options.align.vertical];div.style.width=this._options.width+'px';div.style.height=this._options.height+'px';div.style.padding=this._options.padding+'px';this._appendText(div);return div}},{key:'_appendText',value:function _appendText(div){this._options.paragraphs.forEach(function(paragraph){var p=document.createElement('p');p.style.width='100%';this._fillStyles(p,paragraph);if(!paragraph.characters||paragraph.characters.length===0){p.innerHTML='<span style="color: transparent;">,</span>'}paragraph.characters.forEach(function(character){var c=document.createElement('span');c.innerHTML=character.content;this._fillStyles(c,character);p.appendChild(c)},this);div.appendChild(p)},this)}},{key:'_fillStyles',value:function _fillStyles(target,model){target.style.margin=0;if(model.align&&model.align.horizontal){target.style.textAlign=model.align.horizontal}if(model.padding){target.style.padding=model.padding+'px'}if(model.color){target.style.color=model.color}if(model.background){target.style.background=model.background}if(model.font){if(model.font.family){target.style.fontFamily=model.font.family}if(model.font.size){target.style.fontSize=model.font.size+'px'}}if(model.bold!=null){target.style.fontWeight=model.bold?'bold':'normal'}if(model.italic!=null){target.style.fontStyle=model.italic?'italic':'normal'}if(model.underline&&model.strikethrough){target.style.textDecoration='underline line-through'}else if(model.underline){target.style.textDecoration='underline'}else if(model.strikethrough){target.style.textDecoration='line-through'}if(model.lineHeight!=null){target.style.lineHeight=model.lineHeight+'em'}if(model.letterSpacing!=null){target.style.letterSpacing=model.letterSpacing+'em'}}},{key:'_isMipMap',value:function _isMipMap(image){ //noinspection JSBitwiseOperatorUsage
return !(image.width&image.width-1)&&!(image.height&image.height-1)}},{key:'_nearestPowValue',value:function _nearestPowValue(value){var temp=value;var count=0;while(temp>1){count++;temp/=2}return Math.pow(2,count)}}]);return PlaneText}(_Component3.default);exports.default=PlaneText});
(function(global,factory){if(typeof define==='function'&&define.amd){define('component/ComponentFactory',['exports','./Component','./container/Container','./image/GenericImage','./text/PlaneText'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./Component'),require('./container/Container'),require('./image/GenericImage'),require('./text/PlaneText'))}else {var mod={exports:{}};factory(mod.exports,global.Component,global.Container,global.GenericImage,global.PlaneText);global.ComponentFactory=mod.exports}})(this,function(exports,_Component,_Container,_GenericImage,_PlaneText){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Component2=_interopRequireDefault(_Component);var _Container2=_interopRequireDefault(_Container);var _GenericImage2=_interopRequireDefault(_GenericImage);var _PlaneText2=_interopRequireDefault(_PlaneText);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var ComponentFactory=function(){function ComponentFactory(){_classCallCheck(this,ComponentFactory)}_createClass(ComponentFactory,null,[{key:'create',value:function create(params){if(params instanceof Array){return params.map(ComponentFactory.create)}if(params instanceof _Component2.default){return params}switch(params.class){case 'Container':return new _Container2.default(params);case 'GenericImage':return new _GenericImage2.default(params);case 'PlaneText':return new _PlaneText2.default(params);default: // TODO: Logger
}return null}}]);return ComponentFactory}();exports.default=ComponentFactory});
(function(global,factory){if(typeof define==='function'&&define.amd){define('render/RenderingEngine',['exports','three','../core/events/Event','../core/events/EventTarget','../core/logger/LoggerFactory','../core/utils/ContextHelper','../component/ComponentFactory','../component/Component'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('three'),require('../core/events/Event'),require('../core/events/EventTarget'),require('../core/logger/LoggerFactory'),require('../core/utils/ContextHelper'),require('../component/ComponentFactory'),require('../component/Component'))}else {var mod={exports:{}};factory(mod.exports,global.three,global.Event,global.EventTarget,global.LoggerFactory,global.ContextHelper,global.ComponentFactory,global.Component);global.RenderingEngine=mod.exports}})(this,function(exports,_three,_Event,_EventTarget2,_LoggerFactory,_ContextHelper,_ComponentFactory,_Component){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _three2=_interopRequireDefault(_three);var _Event2=_interopRequireDefault(_Event);var _EventTarget3=_interopRequireDefault(_EventTarget2);var _LoggerFactory2=_interopRequireDefault(_LoggerFactory);var _ContextHelper2=_interopRequireDefault(_ContextHelper);var _ComponentFactory2=_interopRequireDefault(_ComponentFactory);var _Component2=_interopRequireDefault(_Component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass} // get logger.
var logger=_LoggerFactory2.default.getLogger('RenderingEngine'); /**
 * Default renderer options.
 *
 * @type {object}
 * @property {string}   precision   - The shader precision. Should be "highp", "mediump" or "lowp".
 * @property {boolean}  alpha
 * @property {boolean}  premultipliedAlpha - Enable premultiplied alpha. Default is false.
 * @property {boolean}  stencil     - Enable stencil buffer. Default is false.
 * @property {boolean}  preserveDrawingBuffer - Preserve the drawing buffer. Default is true.
 * @property {boolean}  antialias   - Enable antialias. Default is true.
 * @property {number}   clearColor  - Renderer clear color. Default is black.
 */var DEFAULT_RENDERER_OPTIONS={precision:'mediump',alpha:false,premultipliedAlpha:false,stencil:false,preserveDrawingBuffer:false,antialias:true,clearColor:0}; /**
 * Default perspective camera options.
 *
 * @type {object}
 * @property {string}   type    - Camera type. Should be "PerspectiveCamera" or
 *                                "OrthographicCamera"(Unsupported).
 * @property {number}   fov     - Perspective camera frustum vertical field of view.
 * @property {number}   aspect  - Perspective camera frustum aspect ratio.
 * @property {number}   near    - Perspective camera near plane.
 * @property {number}   far     - Perspective camera far plane.
 * @property {object}   position    - Camera position.
 * @property {number}   position.x  - X component.
 * @property {number}   position.y  - Y component.
 * @property {number}   position.z  - Z component.
 * @property {object}   rotation    - Camera rotation.
 * @property {number}   rotation.x  - X component.
 * @property {number}   rotation.y  - Y component.
 * @property {number}   rotation.z  - Z component.
 */var DEFAULT_CAMERA_OPTIONS={type:'PerspectiveCamera',fov:45,aspect:16/9,near:1,far:1000000,position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}}; /**
 * Default scene options.
 * @type {object}
 */var DEFAULT_SCENE_OPTIONS={}; /**
 * Default rendering engine options.
 *
 * @type {object}
 * @property {object}   renderer
 */var DEFAULT_OPTIONS={renderer:DEFAULT_RENDERER_OPTIONS,camera:DEFAULT_CAMERA_OPTIONS,scene:DEFAULT_SCENE_OPTIONS}; // Define the singleton and the enforcer.
var singleton=Symbol();var singletonEnforcer=Symbol(); /**
 *
 * @author hermit
 * @version 1.0.0
 */var RenderingEngine=function(_EventTarget){_inherits(RenderingEngine,_EventTarget); /**
     * Private constructor for create singleton.
     * Use 'RenderingEngine.instance' to get the singleton instance.
     */function RenderingEngine(enforcer){_classCallCheck(this,RenderingEngine);if(enforcer!=singletonEnforcer){var msg='[constructor] Cannot instantiate singleton with constructor.';throw new Error(msg)}var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(RenderingEngine).call(this)); // Declare attributes.
_this._container=null;_this._renderer=null;_this._camera=null;_this._scene=null;_this._components=new Map;return _this} /**
     * Get the singleton.
     * @returns { RenderingEngine } the singleton.
     */_createClass(RenderingEngine,[{key:'initialize',value:function initialize(container){var options=arguments.length<=1||arguments[1]===undefined?DEFAULT_OPTIONS:arguments[1]; // Validate container.
if(!container){var msg='[initialize] Please specify the container.';logger.error(msg,container);throw new Error(msg)} // keep container.
this._container=container; // Create renderer, camera and scene.
this._createRenderer(options.renderer);this._createCamera(options.camera);this._createScene(options.scene)}},{key:'addComponent',value:function addComponent(data){if(data instanceof Array){data.forEach(this.addComponent,this);return} // Get component object.
var component=data instanceof _Component2.default?data:_ComponentFactory2.default.create(data); // Add component to map and graphics to the scene.
this._components.set(component.name,component);this._scene.add(component); // Dispatch events.
this.dispatchEvent(new _Event2.default({type:'ComponentAdded',target:this,arguments:[component]}))}},{key:'get',value:function get(id){if(id==='camera'){return this._camera}if(id==='scene'){return this._scene}return this._components.get(id)}},{key:'render',value:function render(){this._renderer.render(this._scene,this._camera)}},{key:'resize',value:function resize(width,height){this._renderer.setSize(width,height)}},{key:'destroy',value:function destroy(){this._camera=null;this._scene=null}},{key:'snapshot',value:function snapshot(){var image=new Image;image.src=this.domElement.toDataURL();return image}},{key:'snapshotUrl',value:function snapshotUrl(){return this.domElement.toDataURL()}},{key:'_createRenderer',value:function _createRenderer(options){ // Merge renderer options.
options=Object.assign({},DEFAULT_RENDERER_OPTIONS,options); // Create renderer.
if(!this._renderer){this._renderer=new _three2.default.WebGLRenderer({precision:options.precision,alpha:options.alpha,premultipliedAlpha:options.premultipliedAlpha,stencil:options.stencil,preserveDrawingBuffer:options.preserveDrawingBuffer,antialias:options.antialias})}this._renderer.setClearColor(parseInt(options.clearColor));this._container.appendChild(this._renderer.domElement);this._renderer.setSize(this._container.offsetWidth,this._container.offsetHeight); // Dispatch events.
this.dispatchEvent(new _Event2.default({type:'RendererCreated',target:this,arguments:[this._renderer]}))}},{key:'_createCamera',value:function _createCamera(options){ // Merge camera options.
options=Object.assign({},DEFAULT_CAMERA_OPTIONS,options); // Create camera.
this._camera=new _three2.default.PerspectiveCamera(options.fov,options.aspect,options.near,options.far);this._camera.position.x=options.position.x||0;this._camera.position.y=options.position.y||0;this._camera.position.z=options.position.z||0;this._camera.rotation.x=options.rotation.x||0;this._camera.rotation.y=options.rotation.y||0;this._camera.rotation.z=options.rotation.z||0; // Dispatch events.
this.dispatchEvent(new _Event2.default({type:'CameraCreated',target:this,arguments:[this._camera]}))}},{key:'_createScene',value:function _createScene(options){ // Merge scene options.
options=Object.assign({},DEFAULT_SCENE_OPTIONS,options); // Create scene.
this._scene=new _three2.default.Scene; // Dispatch events.
this.dispatchEvent(new _Event2.default({type:'SceneCreated',target:this,arguments:[this._scene]}))}},{key:'domElement',get:function get(){return this._renderer.domElement}}],[{key:'instance',get:function get(){if(!this[singleton]){this[singleton]=new RenderingEngine(singletonEnforcer)}return this[singleton]}}]);return RenderingEngine}(_EventTarget3.default);exports.default=RenderingEngine});
(function(global,factory){if(typeof define==="function"&&define.amd){define('control/Controls',["exports"],factory)}else if(typeof exports!=="undefined"){factory(exports)}else {var mod={exports:{}};factory(mod.exports);global.Controls=mod.exports}})(this,function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value" in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var DEFAULT_OPTIONS={}; /**
 *
 * @author hermit
 * @version 2.0.0
 * @since 1.0.0
 */var Controls=function(){ /**
     * Create controls.
     *
     * @constructor
     * @param params    Parameters for create controls.
     */function Controls(params){_classCallCheck(this,Controls); // Merge options.
this._options=Object.assign({},DEFAULT_OPTIONS,params); // Define the player.
this._player=null;this._enable=false} /**
     * Register controls to the player.
     *
     * @param player Player to be used in.
     */_createClass(Controls,[{key:"register",value:function register(player){this._player=player;this._enable=true}},{key:"unregister",value:function unregister(){this._enable=false;this._player=null;this.destroy()}},{key:"enable",value:function enable(){this._enable=true}},{key:"disable",value:function disable(){this._enable=false}}]);return Controls}();exports.default=Controls});
(function(global,factory){if(typeof define==="function"&&define.amd){define('control/slide/action/Action',["exports"],factory)}else if(typeof exports!=="undefined"){factory(exports)}else {var mod={exports:{}};factory(mod.exports);global.Action=mod.exports}})(this,function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Action=function Action(){_classCallCheck(this,Action)};exports.default=Action});
(function(global,factory){if(typeof define==='function'&&define.amd){define('control/slide/action/KeyframeAction',['exports','tween','./Action'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('tween'),require('./Action'))}else {var mod={exports:{}};factory(mod.exports,global.tween,global.Action);global.KeyframeAction=mod.exports}})(this,function(exports,_tween,_Action2){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _tween2=_interopRequireDefault(_tween);var _Action3=_interopRequireDefault(_Action2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var DEFAULT_DURATION=1000;var DEFAULT_EASING='Sinusoidal.InOut'; /**
 *
 * @author hermit
 * @version 1.0.0
 */var KeyframeAction=function(_Action){_inherits(KeyframeAction,_Action);function KeyframeAction(params){_classCallCheck(this,KeyframeAction);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(KeyframeAction).call(this,params));_this._target=params.target;_this._from=params.from||{};_this._to=params.to||{};_this._duration=params.duration||DEFAULT_DURATION;_this._easing=params.easing||DEFAULT_EASING;_this._createEasing();return _this}_createClass(KeyframeAction,[{key:'forward',value:function forward(engine){this._animate(engine,this._to)}},{key:'backward',value:function backward(engine){this._animate(engine,this._from)}},{key:'_createEasing',value:function _createEasing(){var pair=this._easing.split('.');var equation=pair[0];var easing=pair[1];this._toEasing(equation,easing);this._fromEasing(equation,easing)}},{key:'_toEasing',value:function _toEasing(equation,easing){this._to.easing=_tween2.default.Easing[equation][easing]||_tween2.default.Easing.Sinusoidal.InOut}},{key:'_fromEasing',value:function _fromEasing(equation,easing){var reverse=void 0;switch(easing){case 'In':reverse='Out';break;case 'Out':reverse='In';break;case 'InOut':reverse='InOut';break;default:reverse='InOut';}this._from.easing=_tween2.default.Easing[equation][reverse]||_tween2.default.Easing.Sinusoidal.InOut}},{key:'_animate',value:function _animate(engine,object){ // Get component.
var component=engine.get(this._target); // Check component.
if(!component){ // TODO> LOG.
return} // Define tween list.
var tweens=[];if(object.position){tweens.push(new _tween2.default.Tween(component.position).to(object.position,this._duration).easing(object.easing))}if(object.rotation){var rotation={x:object.rotation.x!=null?object.rotation.x*Math.PI/180:component.rotation.x,y:object.rotation.y!=null?object.rotation.y*Math.PI/180:component.rotation.y,z:object.rotation.z!=null?object.rotation.z*Math.PI/180:component.rotation.z};tweens.push(new _tween2.default.Tween(component.rotation).to(rotation,this._duration).easing(object.easing))}if(object.opacity!=null){tweens.push(new _tween2.default.Tween({opacity:component._opacity}).to({opacity:object.opacity},this._duration).onUpdate(function(){component.opacity=this.opacity}).easing(object.easing))} // Execute tween.
tweens.forEach(function(t){return t.start()})}}]);return KeyframeAction}(_Action3.default);exports.default=KeyframeAction});
(function(global,factory){if(typeof define==='function'&&define.amd){define('control/slide/action/ActionFactory',['exports','./KeyframeAction'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./KeyframeAction'))}else {var mod={exports:{}};factory(mod.exports,global.KeyframeAction);global.ActionFactory=mod.exports}})(this,function(exports,_KeyframeAction){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _KeyframeAction2=_interopRequireDefault(_KeyframeAction);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var ActionFactory=function(){function ActionFactory(){_classCallCheck(this,ActionFactory)}_createClass(ActionFactory,null,[{key:'create',value:function create(options){switch(options.class){case 'KeyframeAction':return new _KeyframeAction2.default(options);default: // TODO:
}}}]);return ActionFactory}();exports.default=ActionFactory});
(function(global,factory){if(typeof define==='function'&&define.amd){define('control/slide/command/Command',['exports','../../../core/utils/UUID','../action/ActionFactory'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('../../../core/utils/UUID'),require('../action/ActionFactory'))}else {var mod={exports:{}};factory(mod.exports,global.UUID,global.ActionFactory);global.Command=mod.exports}})(this,function(exports,_UUID,_ActionFactory){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _UUID2=_interopRequireDefault(_UUID);var _ActionFactory2=_interopRequireDefault(_ActionFactory);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var DEFAULT_OPTIONS={id:_UUID2.default.generate(),actions:[]}; /**
 *
 * @author hermit
 * @version 1.0.0
 */var Command=function(){function Command(params){_classCallCheck(this,Command); // Merge options.
this._options=Object.assign({},DEFAULT_OPTIONS,params); // Define attributes.
this._parent=null;this._children=[];this._actions=[]; // Create actions.
this._options.actions.forEach(function(args){this._actions.push(_ActionFactory2.default.create(args))},this)}_createClass(Command,[{key:'add',value:function add(command){if(command instanceof Array){command.forEach(this.add,this)}else {this._children.push(command)}}},{key:'forward',value:function forward(engine){this._actions.forEach(function(action){return action.forward(engine)})}},{key:'backward',value:function backward(engine){this._actions.forEach(function(action){return action.backward(engine)})}},{key:'parent',get:function get(){return this._parent}},{key:'children',get:function get(){return this._children}}]);return Command}();exports.default=Command});
(function(global,factory){if(typeof define==='function'&&define.amd){define('control/slide/command/ContentCommand',['exports','./Command'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./Command'))}else {var mod={exports:{}};factory(mod.exports,global.Command);global.ContentCommand=mod.exports}})(this,function(exports,_Command2){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Command3=_interopRequireDefault(_Command2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ContentCommand=function(_Command){_inherits(ContentCommand,_Command);function ContentCommand(){_classCallCheck(this,ContentCommand);return _possibleConstructorReturn(this,Object.getPrototypeOf(ContentCommand).apply(this,arguments))}return ContentCommand}(_Command3.default);exports.default=ContentCommand});
(function(global,factory){if(typeof define==='function'&&define.amd){define('control/slide/command/ElementCommand',['exports','./Command'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./Command'))}else {var mod={exports:{}};factory(mod.exports,global.Command);global.ElementCommand=mod.exports}})(this,function(exports,_Command2){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Command3=_interopRequireDefault(_Command2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ElementCommand=function(_Command){_inherits(ElementCommand,_Command);function ElementCommand(){_classCallCheck(this,ElementCommand);return _possibleConstructorReturn(this,Object.getPrototypeOf(ElementCommand).apply(this,arguments))}return ElementCommand}(_Command3.default);exports.default=ElementCommand});
(function(global,factory){if(typeof define==='function'&&define.amd){define('control/slide/command/HelperCommand',['exports','./Command'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./Command'))}else {var mod={exports:{}};factory(mod.exports,global.Command);global.HelperCommand=mod.exports}})(this,function(exports,_Command2){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Command3=_interopRequireDefault(_Command2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var HelperCommand=function(_Command){_inherits(HelperCommand,_Command);function HelperCommand(){_classCallCheck(this,HelperCommand);return _possibleConstructorReturn(this,Object.getPrototypeOf(HelperCommand).apply(this,arguments))}return HelperCommand}(_Command3.default);exports.default=HelperCommand});
(function(global,factory){if(typeof define==='function'&&define.amd){define('control/slide/command/TopicCommand',['exports','./Command'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./Command'))}else {var mod={exports:{}};factory(mod.exports,global.Command);global.TopicCommand=mod.exports}})(this,function(exports,_Command2){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Command3=_interopRequireDefault(_Command2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var TopicCommand=function(_Command){_inherits(TopicCommand,_Command);function TopicCommand(){_classCallCheck(this,TopicCommand);return _possibleConstructorReturn(this,Object.getPrototypeOf(TopicCommand).apply(this,arguments))}return TopicCommand}(_Command3.default);exports.default=TopicCommand});
(function(global,factory){if(typeof define==='function'&&define.amd){define('control/slide/command/CommandFactory',['exports','../command/ContentCommand','../command/ElementCommand','../command/HelperCommand','../command/TopicCommand'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('../command/ContentCommand'),require('../command/ElementCommand'),require('../command/HelperCommand'),require('../command/TopicCommand'))}else {var mod={exports:{}};factory(mod.exports,global.ContentCommand,global.ElementCommand,global.HelperCommand,global.TopicCommand);global.CommandFactory=mod.exports}})(this,function(exports,_ContentCommand,_ElementCommand,_HelperCommand,_TopicCommand){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _ContentCommand2=_interopRequireDefault(_ContentCommand);var _ElementCommand2=_interopRequireDefault(_ElementCommand);var _HelperCommand2=_interopRequireDefault(_HelperCommand);var _TopicCommand2=_interopRequireDefault(_TopicCommand);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var CommandFactory=function(){function CommandFactory(){_classCallCheck(this,CommandFactory)}_createClass(CommandFactory,null,[{key:'create',value:function create(params){switch(params.class){case 'TopicCommand':return new _TopicCommand2.default(params);case 'ContentCommand':return new _ContentCommand2.default(params);case 'ElementCommand':return new _ElementCommand2.default(params);case 'HelperCommand':return new _HelperCommand2.default(params);default: // TODO:
}return null}}]);return CommandFactory}();exports.default=CommandFactory});
(function(global,factory){if(typeof define==='function'&&define.amd){define('control/slide/SlideControl',['exports','../Controls','./command/CommandFactory','./command/ContentCommand','./command/ElementCommand','./command/HelperCommand','./command/TopicCommand','../../core/utils/ContextHelper'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('../Controls'),require('./command/CommandFactory'),require('./command/ContentCommand'),require('./command/ElementCommand'),require('./command/HelperCommand'),require('./command/TopicCommand'),require('../../core/utils/ContextHelper'))}else {var mod={exports:{}};factory(mod.exports,global.Controls,global.CommandFactory,global.ContentCommand,global.ElementCommand,global.HelperCommand,global.TopicCommand,global.ContextHelper);global.SlideControl=mod.exports}})(this,function(exports,_Controls2,_CommandFactory,_ContentCommand,_ElementCommand,_HelperCommand,_TopicCommand,_ContextHelper){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Controls3=_interopRequireDefault(_Controls2);var _CommandFactory2=_interopRequireDefault(_CommandFactory);var _ContentCommand2=_interopRequireDefault(_ContentCommand);var _ElementCommand2=_interopRequireDefault(_ElementCommand);var _HelperCommand2=_interopRequireDefault(_HelperCommand);var _TopicCommand2=_interopRequireDefault(_TopicCommand);var _ContextHelper2=_interopRequireDefault(_ContextHelper);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var SlideControl=function(_Controls){_inherits(SlideControl,_Controls);function SlideControl(){_classCallCheck(this,SlideControl);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(SlideControl).call(this)); // Define attributes.
_this._index=-1;_this._commandTree=null;_this._commands=[];return _this}_createClass(SlideControl,[{key:'load',value:function load(data){this._commandTree=this._buildCommandTree(data);this._commands=this._buildCommandQueue()}},{key:'execCommand',value:function execCommand(index){if(!this._enable){return} // Forward.
if(index>this._index){var commands=this._commands.slice(this._index+1,index+1);commands.forEach(function(array){var _this2=this;array.forEach(function(command){return command.forward(_this2._player.renderingEngine)})},this)} // Backward.
if(index<this._index){var _commands=this._commands.slice(index+1,this._index+1);_commands.forEach(function(array){ // Topic commands || helper commands.
if(array.length===1){array[0].backward(this._player.renderingEngine)} // Topic commands && content commands.
if(array.length>1){var topic=array[0];var content=array[1];var contentIndex=topic.children.indexOf(content);if(contentIndex===0){topic.backward(this._player.renderingEngine);content.backward(this._player.renderingEngine)}else {topic.forward(this._player.renderingEngine);content.backward(this._player.renderingEngine)}}},this)} // Update current command index.
this._index=index}},{key:'prevCommand',value:function prevCommand(){if(this._index>0){this.execCommand(this._index-1)}}},{key:'nextCommand',value:function nextCommand(){if(this._index+1<this._commands.length){this.execCommand(this._index+1)}}},{key:'_buildCommandTree',value:function _buildCommandTree(data){function create(params){var command=_CommandFactory2.default.create(params);if(params.children){var children=params.children.map(create,this);command.add(children)}return command}return data.commands.map(create,this)}},{key:'_buildCommandQueue',value:function _buildCommandQueue(){var queue=[];this._commandTree.forEach(function(command){if(command instanceof _HelperCommand2.default){queue.push([command])}if(command instanceof _TopicCommand2.default){if(command.children&&command.children.length>0){command.children.forEach(function(child){queue.push([command,child])})}else {queue.push([command])}}});return queue}}]);return SlideControl}(_Controls3.default);exports.default=SlideControl});
(function(global,factory){if(typeof define==='function'&&define.amd){define('player/Player',['exports','tween','../assets/AssetManager','../core/events/Event','../core/events/EventTarget','../core/utils/ContextHelper','../render/RenderingEngine','../control/slide/SlideControl','../component/ComponentFactory'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('tween'),require('../assets/AssetManager'),require('../core/events/Event'),require('../core/events/EventTarget'),require('../core/utils/ContextHelper'),require('../render/RenderingEngine'),require('../control/slide/SlideControl'),require('../component/ComponentFactory'))}else {var mod={exports:{}};factory(mod.exports,global.tween,global.AssetManager,global.Event,global.EventTarget,global.ContextHelper,global.RenderingEngine,global.SlideControl,global.ComponentFactory);global.Player=mod.exports}})(this,function(exports,_tween,_AssetManager,_Event,_EventTarget2,_ContextHelper,_RenderingEngine,_SlideControl,_ComponentFactory){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _tween2=_interopRequireDefault(_tween);var _AssetManager2=_interopRequireDefault(_AssetManager);var _Event2=_interopRequireDefault(_Event);var _EventTarget3=_interopRequireDefault(_EventTarget2);var _ContextHelper2=_interopRequireDefault(_ContextHelper);var _RenderingEngine2=_interopRequireDefault(_RenderingEngine);var _SlideControl2=_interopRequireDefault(_SlideControl);var _ComponentFactory2=_interopRequireDefault(_ComponentFactory);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass} /**
 * Define the default player options.
 *
 * @type {object}
 * @property {boolean}  ignore - Ignore errors. Default is false.
 */var DEFAULT_OPTIONS={ignore:false};var Status={WAIT:'WAIT',LOADING:'LOADING',OPENED:'OPENED',PLAYING:'PLAYING',PAUSE:'PAUSE',ERROR:'ERROR'}; /**
 *
 * @author hermit
 * @version 2.0.0
 * @since 1.0.0
 */var Player=function(_EventTarget){_inherits(Player,_EventTarget); /**
     * Construct player with specified container and options.
     *
     * @param container Container to append player.
     * @param options   Options for player.
     */function Player(container,options){_classCallCheck(this,Player);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(Player).call(this)); // Merge player options.
_this._options=Object.assign({},DEFAULT_OPTIONS,options); // Declare attributes.
_this._requestId=0;_this._bpd=null; // Bifrost playable document.
_this._status=Status.WAIT;_this._container=container;_this._renderingEngine=_RenderingEngine2.default.instance;_this._assetManager=_AssetManager2.default.instance;_this._controls=new Map; // Propagate events.
_this.propagateEvent('RendererCreated',_this._renderingEngine);_this.propagateEvent('CameraCreated',_this._renderingEngine);_this.propagateEvent('SceneCreated',_this._renderingEngine);_this.propagateEvent('ComponentAdded',_this._renderingEngine);return _this} /**
     * Open the specified bifrost playable document.
     *
     * @param bpd   Bifrost playable document for play.
     */_createClass(Player,[{key:'open',value:function open(bpd){ // Stop first if player is running.
if(this._status!=Status.WAIT){this.stop()} // Keep the bpd.
this._bpd=bpd; // Update player status.
this._status=Status.LOADING; // Open document.
this._loadAssets(bpd.assets).then(_ContextHelper2.default.delegate(this._initRenderingEngine,this)).then(_ContextHelper2.default.delegate(this._loadComponents,this)).then(_ContextHelper2.default.delegate(this._loadControl,this)).then(_ContextHelper2.default.delegate(function(){this._status=Status.OPENED;this.dispatchEvent(new _Event2.default({type:'BPDOpenSuccess',target:this,arguments:[]},this))},this)).catch(_ContextHelper2.default.delegate(function(e){ // Update player status.
this._status=Status.ERROR; // Dispatch events.
this.dispatchEvent(new _Event2.default({type:'BPDOpenFailure',target:this,arguments:[e]},this))},this))}},{key:'play',value:function play(){function render(delta){_tween2.default.update(delta);this._renderingEngine.render();this._requestId=requestAnimationFrame(_ContextHelper2.default.delegate(render,this))}if(this._status===Status.OPENED||this._status===Status.PAUSE){ // Update player status.
this._status=Status.PLAYING; // Enable controls.
this._controls.forEach(function(control){return control.enable()}); // Render
this._requestId=requestAnimationFrame(_ContextHelper2.default.delegate(render,this))}}},{key:'pause',value:function pause(){if(this._status===Status.PLAYING){ // Disable controls.
this._controls.forEach(function(control){return control.disable()}); // Stop render.
cancelAnimationFrame(this._requestId)}}},{key:'stop',value:function stop(){if(this._status===Status.PLAYING||this._status===Status.PAUSE||this._status===Status.ERROR){ // Update status.
this._status=Status.WAIT; // Stop rendering loop.
cancelAnimationFrame(this._requestId); // Unregister controls.
this._controls.clear(); // Reset asset manager.
this._assetManager.clear(); // Destroy rendering engine.
this._renderingEngine.destroy()}}},{key:'registerControl',value:function registerControl(control){control.register(this);this._controls.set(control.constructor.name,control)}},{key:'getControl',value:function getControl(type){return this._controls.get(type)}},{key:'resize',value:function resize(width,height){this._renderingEngine.resize(width,height)}},{key:'snapshot',value:function snapshot(){return this._renderingEngine.snapshot()}},{key:'snapshotUrl',value:function snapshotUrl(){return this._renderingEngine.snapshotUrl()}},{key:'_loadAssets',value:function _loadAssets(assets){return new Promise(_ContextHelper2.default.delegate(function(resolve,reject){var totalCount=assets.length;var successCount=0;var failureCount=0; // Bind asset load events.
this._assetManager.addEventListener('AssetLoadSuccess',_ContextHelper2.default.delegate(function(event,asset){ // Increase loaded assets count.
++successCount; // Dispatch progressing event.
this.dispatchEvent(new _Event2.default({type:'AssetLoadSuccess',target:this,arguments:[asset,{total:totalCount,success:successCount,failure:failureCount}]})); // Resolve promise when all assets are loaded.
if(successCount+failureCount>=totalCount){if(this._options.ignore){resolve()}else {reject('Asset Load Failure.')}}},this));this._assetManager.addEventListener('AssetLoadFailure',_ContextHelper2.default.delegate(function(event,asset){ // Increase failure assets count.
++failureCount; // Dispatch failure event.
this.dispatchEvent(new _Event2.default({type:'AssetLoadFailure',target:this,arguments:[asset,{total:totalCount,success:successCount,failure:failureCount}]})); // Resolve promise when all assets are loaded.
if(successCount+failureCount>=totalCount){if(this._options.ignore){resolve()}else {reject('Asset Load Failure.')}}},this)); // Add assets.
this._assetManager.add(assets)},this))}},{key:'_initRenderingEngine',value:function _initRenderingEngine(){ // Initialize rendering engine.
this._renderingEngine.initialize(this._container,{renderer:{clearColor:this._bpd.clearColor},camera:this._bpd.camera}); // Dispatch event.
this.dispatchEvent(new _Event2.default({type:'RenderingEngineLoaded',target:this,arguments:[]}))}},{key:'_loadComponents',value:function _loadComponents(){function create(params){ // Construct component.
var component=_ComponentFactory2.default.create(params); // Append children.
if(params.children){var children=params.children.map(create,this);children.forEach(function(child){return component.add(child)})} // Add component to rendering engine.
this._renderingEngine.addComponent(component);return component} // Create component.
this._bpd.scene.children.forEach(create,this); // Dispatch event.
this.dispatchEvent(new _Event2.default({type:'ComponentLoaded',target:this,arguments:[]}))}},{key:'_loadControl',value:function _loadControl(){this._bpd.controls.forEach(function(data){if(data.class==='SlideControl'){ // Create slide control.
var control=new _SlideControl2.default(data.options);control.load(data);this.registerControl(control);control.execCommand(0)}else {console.log('Not supported yet.')}},this)}},{key:'renderingEngine',get:function get(){return this._renderingEngine}}]);return Player}(_EventTarget3.default);exports.default=Player});
(function(global,factory){if(typeof define==='function'&&define.amd){define('Bifrost',['exports','./player/Player','./core/utils/ContextHelper','./component/image/GenericImage'],factory)}else if(typeof exports!=='undefined'){factory(exports,require('./player/Player'),require('./core/utils/ContextHelper'),require('./component/image/GenericImage'))}else {var mod={exports:{}};factory(mod.exports,global.Player,global.ContextHelper,global.GenericImage);global.Bifrost=mod.exports}})(this,function(exports,_Player,_ContextHelper,_GenericImage){'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _Player2=_interopRequireDefault(_Player);var _ContextHelper2=_interopRequireDefault(_ContextHelper);var _GenericImage2=_interopRequireDefault(_GenericImage);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else {return Array.from(arr)}} /**
 * Define the Bifrost library.
 *
 * @type {{version: string, dependencies: {}}}
 */var Bifrost={version:'2.0.0',dependencies:{}}; /**
 * Export player.
 *
 * @type {Player}
 */Bifrost.Player=_Player2.default;Bifrost.test=function(){var map=new Map;map.set(1,'1');map.set(2,'2');return [].concat(_toConsumableArray(map.values()))};exports.default=Bifrost});
